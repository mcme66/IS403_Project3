<%- include('partials/header', { title: 'Events List' }) %>

<main class="page-content-wrapper">
    
    <div class="page-header-container">
      <h2 class="page-title" style="font-size: 2rem; margin: 0;">All Events</h2>
      
      <% if (user && user.isOrganizer) { %>
        <a href="/events/add" class="action-btn add-btn-custom">+ Add Event</a>
      <% } %>
    </div>

    <div class="table-container">
      <table class="styled-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Competition ID</th>
            <th>Title</th>
            <th>Start</th>
            <th>End</th>
            <th>Rounds</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <% events.forEach(e=> { %>
            <tr>
              <td>
                <%= e.event_id %>
              </td>
              <td>
                <a href="/competitions/<%= e.competition_id %>" class="text-cyan">
                  <%= e.competition_id || '-' %>
                </a>
              </td>
              <td>
                <%= e.title %>
              </td>
              <td>
                <%= e.start_date_time ? new Date(e.start_date_time).toLocaleString() : '-' %>
              </td>
              <td>
                <%= e.end_date_time ? new Date(e.end_date_time).toLocaleString() : '-' %>
              </td>
              <td>
                <%= e.rounds || '-' %>
              </td>
              <td>
                <% if (user && user.isOrganizer) { %>
                  <a href="/events/edit/<%= e.event_id %>/<%= e.competition_id %>" class="btn btn-edit">Edit</a>
                  <a href="/events/delete/<%= e.event_id %>" class="btn-delete"
                    onclick="return confirm('Delete this event?')">Delete</a>
                  <% } %>
              </td>
            </tr>
            <% }) %>
        </tbody>
      </table>
    </div>

  </main>
<%- include('partials/footer') %>